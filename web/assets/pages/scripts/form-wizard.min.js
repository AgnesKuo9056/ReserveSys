var FormWizard={init:function(){if(jQuery().bootstrapWizard){$("#country_list").select2({placeholder:"Select",allowClear:!0,formatResult:n,width:"auto",formatSelection:n,escapeMarkup:function(e){return e}});var e=$("#submit_form"),t=$(".alert-danger",e),r=$(".alert-success",e);e.validate({doNotHideMessage:!0,errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,rules:{username:{minlength:5,maxlength:15,required:!0},password:{minlength:5,required:!0},rpassword:{minlength:5,required:!0,equalTo:"#submit_form_password"},fullname:{minlength:3,maxlength:10,required:!0},email:{required:!0,email:!0},phone:{digits:!0,required:!0},gender:{required:!0},address:{required:!0},city:{required:!0},country:{required:!0},card_name:{required:!0},card_number:{minlength:16,maxlength:16,required:!0},card_cvc:{digits:!0,required:!0,minlength:3,maxlength:4},card_expiry_date:{required:!0},"payment[]":{required:!0,minlength:1},number:{digits:!0,required:!0,minlength:1,maxlength:3},price_number:{digits:!0,required:!0,minlength:1}},messages:{"payment[]":{required:"Please select at least one option",minlength:jQuery.validator.format("Please select at least one option")}},errorPlacement:function(e,t){"gender"==t.attr("name")?e.insertAfter("#form_gender_error"):"payment[]"==t.attr("name")?e.insertAfter("#form_payment_error"):e.insertAfter(t)},invalidHandler:function(e,i){r.hide(),t.show(),App.scrollTo(t,-200)},highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},success:function(e){"gender"==e.attr("for")||"payment[]"==e.attr("for")?(e.closest(".form-group").removeClass("has-error").addClass("has-success"),e.remove()):e.addClass("valid").closest(".form-group").removeClass("has-error").addClass("has-success")},submitHandler:function(e){r.show(),t.hide(),e.submit()}});var i=function(){$("#tab4 .form-control-static",e).each(function(){var t=$('[name="'+$(this).attr("data-display")+'"]',e);if(t.is(":radio")&&(t=$('[name="'+$(this).attr("data-display")+'"]:checked',e)),t.is(":text")||t.is("textarea"))$(this).html(t.val());else if(t.is("select"))$(this).html(t.find("option:selected").text());else if(t.is(":radio")&&t.is(":checked"))$(this).html(t.attr("data-title"));else if("payment[]"==$(this).attr("data-display")){var r=[];$('[name="payment[]"]:checked',e).each(function(){r.push($(this).attr("data-title"))}),$(this).html(r.join("<br>"))}else if(t.is(":file")){var i=document.getElementById("img-box").getElementsByTagName("img");if("gh"==$(this).attr("data-display")){console.log("民宿照片");for(var a="",n=0;n<i.length;n++)a+='<img src="'+i[n].currentSrc+'" style="max-width:100px;max-height:100px;margin-right:5px;"/>';$("#show_result_pic").append(a)}else $("#img-box-two li img").each(function(){i.push($(this).attr("src"))})}})},a=function(e,t,r){var a=t.find("li").length,n=r+1;$(".step-title",$("#form_wizard_1")).text("Step "+(r+1)+" of "+a),jQuery("li",$("#form_wizard_1")).removeClass("done");for(var s=t.find("li"),o=0;o<r;o++)jQuery(s[o]).addClass("done");1==n?$("#form_wizard_1").find(".button-previous").hide():$("#form_wizard_1").find(".button-previous").show(),n>=a?($("#form_wizard_1").find(".button-next").hide(),$("#form_wizard_1").find(".button-submit").show(),i()):($("#form_wizard_1").find(".button-next").show(),$("#form_wizard_1").find(".button-submit").hide()),App.scrollTo($(".page-title"))};$("#form_wizard_1").bootstrapWizard({nextSelector:".button-next",previousSelector:".button-previous",onTabClick:function(e,t,r,i){return!1},onNext:function(i,n,s){if(r.hide(),t.hide(),!1==e.valid())return!1;a(i,n,s)},onPrevious:function(e,i,n){r.hide(),t.hide(),a(e,i,n)},onTabShow:function(e,t,r){var i=t.find("li").length;$("#form_wizard_1").find(".progress-bar").css({width:(r+1)/i*100+"%"})}}),$("#form_wizard_1").find(".button-previous").hide(),$("#form_wizard_1 .button-submit").click(function(){alert("已提交审核,请稍等1-2个工作天")}).hide(),$("#country_list",e).change(function(){e.validate().element($(this))})}function n(e){return e.id?"<img class='flag' src='../../assets/global/img/flags/"+e.id.toLowerCase()+".png'/>&nbsp;&nbsp;"+e.text:e.text}}};jQuery(document).ready(function(){FormWizard.init()});